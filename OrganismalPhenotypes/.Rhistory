facet_grid(Age2~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","alpha","beta","log(*mu*)45","log(*mu*)60"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age2~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","alpha","beta","mu45","mu60"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age2~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","alpha","beta","mu*45","mu*60"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","alpha","beta","mu[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","Log*alpha","beta","mu[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","Log(*alpha*)","beta","mu[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'Log('*alpha*')'","beta","mu[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","mu[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","'log('*mu[45]*')'","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","'log('*mu*')'[45]","mu[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","'log('*mu*')'[45]","'log('*mu*')'[45]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
# LongDT_NoLateAges$Age2<-factor(LongDT_NoLateAges$Age,
#                                labels=c("Day 04","Day 10","Day 24","Day 45"))
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","'log('*mu*')'[45]","'log('*mu*')'[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
LongDT_NoLateAges$Phenotype2<-factor(LongDT_NoLateAges$Phenotype,
labels=c("MeanLS","'log('*alpha*')'","beta","'log('*mu*')'[45]","'log('*mu*')'[60]"))
Plot<-ggplot(na.omit(LongDT_NoLateAges),aes(x=Measurement,y=Residual))+geom_point()+
theme_bw()+geom_smooth(method="lm",col="red")+
facet_grid(Age~Phenotype2,scales='free_x',labeller=label_parsed)+
ylab("Age Acceleration")+theme(axis.text.x=element_text(size=6),axis.title.x=element_blank())
Plot
pdf("AgeAcceleration.pdf",width=8,height=6)
Plot
dev.off()
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(data.table)
library(tidyverse)
library(survival)
library(survminer)
library(scales)
library(splitstackshape)
DL20<-fread("Lifespan20_Raw.txt")
SurvObj<-function(DL) {
InfoDL<-DL[(Censored>0 | IntDeaths>0), .(AgeH, Chamber, UniqueName, Deaths, Carried, Censored, IntDeaths, N)]
eDL<-InfoDL[, .(AgeH, Chamber, UniqueName, Censored, IntDeaths)]
Deaths<-expandRows(eDL[,.(AgeH, Chamber, UniqueName, IntDeaths)], "IntDeaths")
Deaths$Deaths<-1 #Assign value 1 to each expanded row
Deaths$Censored<-0 #Assign value 0 to each expanded row
Censored<-expandRows(eDL[,.(AgeH, Chamber, UniqueName, Censored)], "Censored")
Censored$Censored<-1
Censored$Deaths<-0
temp<-rbind(Deaths, Censored) #temp$Deaths is equivalent to event in the survival object, as all deaths are 1 and all censored are 0
Data<-temp[,Genotype:=UniqueName]
Data$AgeD<-(Data$AgeH)/24
return(Data)
}
ndeath<-rep(NA,length(unique(DL20$UniqueName)))
rmean<-rep(NA,length(unique(DL20$UniqueName)))
se<-rep(NA,length(unique(DL20$UniqueName)))
median<-rep(NA,length(unique(DL20$UniqueName)))
for (i in 1:length(unique(DL20$UniqueName))) {
SubData<-DL20[UniqueName==unique(DL20$UniqueName)[i]]
Data<-SurvObj(SubData)
fit<-survfit(Surv(AgeD,Deaths)~1, data=Data)
ndeath[i]<-summary(fit)$table[4]
rmean[i]<-summary(fit)$table[5]
se[i]<-summary(fit)$table[6]
median[i]<-summary(fit)$table[7]
SummaryStats<-data.table(Genotype=unique(DL20$UniqueName),NDeath=ndeath,Mean=rmean,Se=se,Median=median)
}
SummaryStats<-SummaryStats[order(Genotype)]
write.table(SummaryStats,"MeanLS_20.txt",sep="\t",quote=F,row.names=F)
Surv20<-SurvObj(DL20)
fit20<-survfit(Surv(AgeD,Deaths)~Genotype,data=Surv20)
print(fit20,rmean="individual")
Diff<-survdiff(Surv(AgeD,Deaths)~Genotype,data=Surv20)
Diff
LS<-SummaryStats
OrderLS<-arrange(LS,Mean)
Color<-seq_gradient_pal("red","blue","Lab")(seq(0,1,length.out=20))
ColorMatch<-data.table(Genotype=OrderLS$Genotype,Color)
ColorMatch<-ColorMatch[order(Genotype)]
OrderedColor<-ColorMatch$Color
fit<-survfit(Surv(AgeD,Deaths)~Genotype, data=Surv20)
p<-ggsurvplot_list(fit,Surv20,xlim=c(0,100),palette=OrderedColor,ggtheme=theme_bw(),legend.title="")+xlab("Time (Days)")+ylab("Survivorship")
pdf("SurvivalCurves_20Genotypes.pdf", width=10, height=4)
p[[1]]+theme(legend.position="none")
dev.off()
pdf("SurvivalCurves_20Genotypes_SampleAges.pdf", width=8, height=4)
p[[1]]+geom_vline(xintercept=c(4,10,24,45,69,80),col="cyan3")+theme(legend.position="none")
dev.off()
Data<-SummaryStats
SortData<-Data[order(Mean)]
pdf("LSVariation_20Genotypes.pdf", width=4, height=4)
ggplot(SortData,aes(x=1:20,y=Mean))+geom_point()+geom_errorbar(aes(ymin=Mean-Se,ymax=Mean+Se))+theme_bw()+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())+
xlab("Genotype")+ylab("Mean Lifespan (Days)")+scale_y_continuous(limits=c(30,85))
dev.off()
library(GGally)
Data<-fread("DemographySummary.txt")
Matrix<-as.matrix(Data[,c(3,4,5,6,8,9)])
rownames(Matrix)<-Data$Genotype
colnames(Matrix)<-c("MeanLS","MedianLS","LogAlpha","Beta","LogMiu45","LogMiu60")
pairs(Matrix,pch=20)
DF<-Data[,c(3,5,6)]
a<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),diag=list(continuous="bar"))+theme_bw()
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"), columnLabels=c("Mean Lifespan","log (Alpha)","Beta"))+theme_bw()
b
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),
columnLabels=c("Mean Lifespan",expression(paste('log(',alpha,')')),expression(beta)))+theme_bw()
b
?ggpairs
DF
str(DF)
colnames(DF)<-c("Mean Lifespan","'log('*alpha*')'","beta")
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),
labeller=label_parsed)+theme_bw()
b
colnames(DF)<-c("MeanLifespan","'log('*alpha*')'","beta")
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),
labeller=label_parsed)+theme_bw()
b
colnames(DF)<-c("MeanLifespan","'log('*alpha*')'","beta")
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),
labeller=label_parsed)+theme_bw()
pdf("LSCorrelation.pdf", width=5, height=4)
b
dev.off()
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(data.table)
library(dplyr)
library(ggplot2)
library(ggExtra)
library(corrplot)
Pheno<-fread("Pheno20.txt")
Matrix<-as.matrix(Pheno[,c(3:5,8:14)])
rownames(Matrix)<-Pheno$Genotype
colnames(Matrix)<-c("MeanLS","LogAlpha","Beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
pdf("PhenotypeCor_Genotype20.pdf", width=5, height=5)
corrplot(Cor, method = "circle",type="lower")
dev.off()
?corrplot
colnames(Matrix)<-c("MeanLS","LogAlpha",expression(beta),"RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
Cor
corrplot(Cor, method = "circle",type="lower")
colnames(Matrix)<-c("MeanLS","LogAlpha",expression(beta),"RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
corrplot(Cor, method = "circle",type="lower")
colnames(Matrix)<-c("MeanLS",":'log('alpha')'",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
corrplot(Cor, method = "circle",type="lower")
colnames(Matrix)<-c("MeanLS",":'log(':alpha')'",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
corrplot(Cor, method = "circle",type="lower")
colnames(Matrix)<-c("MeanLS","'log(':alpha')'",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
corrplot(Cor, method = "circle",type="lower")
colnames(Matrix)<-c("MeanLS",":log(alpha)",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
corrplot(Cor, method = "circle",type="lower")
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(data.table)
library(dplyr)
library(ggplot2)
library(ggExtra)
library(corrplot)
Pheno<-fread("Pheno20.txt")
Matrix<-as.matrix(Pheno[,c(3:5,8:14)])
rownames(Matrix)<-Pheno$Genotype
# colnames(Matrix)<-c("MeanLS","LogAlpha","Beta","RepOutput_Day08","RepOutput_Day12",
#                     "Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
colnames(Matrix)<-c("MeanLS",":log(alpha)",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
pdf("PhenotypeCor_Genotype20.pdf", width=5, height=5)
corrplot(Cor, method = "circle",type="lower")
dev.off()
CorPearson<-cor(Matrix,method="pearson",use="pairwise.complete.obs")
pdf("PhenotypeCorPearson_Genotype20.pdf", width=5, height=5)
corrplot(CorPearson, method = "circle",type="lower")
dev.off()
shapiro.test(Pheno$MeanLS)
shapiro.test(Pheno$LogMAlpha)
shapiro.test(Pheno$MBeta)
shapiro.test(Pheno$RepOutput_Day08)
shapiro.test(Pheno$RepOutput_Day12)
shapiro.test(Pheno$Week3)
shapiro.test(Pheno$Week4)
shapiro.test(Pheno$Week5)
shapiro.test(Pheno$Week6)
shapiro.test(Pheno$Slope)
cor.test(Pheno$MeanLS,Pheno$RepOutput_Day08, method="spearman")
cor.test(Pheno$MeanLS,Pheno$RepOutput_Day12, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week3, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week4, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week5, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week6, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Slope, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$RepOutput_Day08, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$RepOutput_Day12, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$Week3, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$Week5, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$Slope, method="spearman")
cor.test(Pheno$MBeta,Pheno$RepOutput_Day08, method="spearman")
cor.test(Pheno$MBeta,Pheno$RepOutput_Day12, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week3, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week4, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week5, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week6, method="spearman")
cor.test(Pheno$MBeta,Pheno$Slope, method="spearman")
library(data.table)
library(tidyverse)
library(survival)
library(survminer)
library(scales)
library(splitstackshape)
DL20<-fread("Lifespan20_Raw.txt")
SurvObj<-function(DL) {
InfoDL<-DL[(Censored>0 | IntDeaths>0), .(AgeH, Chamber, UniqueName, Deaths, Carried, Censored, IntDeaths, N)]
eDL<-InfoDL[, .(AgeH, Chamber, UniqueName, Censored, IntDeaths)]
Deaths<-expandRows(eDL[,.(AgeH, Chamber, UniqueName, IntDeaths)], "IntDeaths")
Deaths$Deaths<-1 #Assign value 1 to each expanded row
Deaths$Censored<-0 #Assign value 0 to each expanded row
Censored<-expandRows(eDL[,.(AgeH, Chamber, UniqueName, Censored)], "Censored")
Censored$Censored<-1
Censored$Deaths<-0
temp<-rbind(Deaths, Censored) #temp$Deaths is equivalent to event in the survival object, as all deaths are 1 and all censored are 0
Data<-temp[,Genotype:=UniqueName]
Data$AgeD<-(Data$AgeH)/24
return(Data)
}
ndeath<-rep(NA,length(unique(DL20$UniqueName)))
rmean<-rep(NA,length(unique(DL20$UniqueName)))
se<-rep(NA,length(unique(DL20$UniqueName)))
median<-rep(NA,length(unique(DL20$UniqueName)))
for (i in 1:length(unique(DL20$UniqueName))) {
SubData<-DL20[UniqueName==unique(DL20$UniqueName)[i]]
Data<-SurvObj(SubData)
fit<-survfit(Surv(AgeD,Deaths)~1, data=Data)
ndeath[i]<-summary(fit)$table[4]
rmean[i]<-summary(fit)$table[5]
se[i]<-summary(fit)$table[6]
median[i]<-summary(fit)$table[7]
SummaryStats<-data.table(Genotype=unique(DL20$UniqueName),NDeath=ndeath,Mean=rmean,Se=se,Median=median)
}
SummaryStats<-SummaryStats[order(Genotype)]
write.table(SummaryStats,"MeanLS_20.txt",sep="\t",quote=F,row.names=F)
Surv20<-SurvObj(DL20)
fit20<-survfit(Surv(AgeD,Deaths)~Genotype,data=Surv20)
print(fit20,rmean="individual")
Diff<-survdiff(Surv(AgeD,Deaths)~Genotype,data=Surv20)
Diff
LS<-SummaryStats
OrderLS<-arrange(LS,Mean)
Color<-seq_gradient_pal("red","blue","Lab")(seq(0,1,length.out=20))
ColorMatch<-data.table(Genotype=OrderLS$Genotype,Color)
ColorMatch<-ColorMatch[order(Genotype)]
OrderedColor<-ColorMatch$Color
fit<-survfit(Surv(AgeD,Deaths)~Genotype, data=Surv20)
p<-ggsurvplot_list(fit,Surv20,xlim=c(0,100),palette=OrderedColor,ggtheme=theme_bw(),legend.title="")+xlab("Time (Days)")+ylab("Survivorship")
Data<-SummaryStats
SortData<-Data[order(Mean)]
library(GGally)
Data<-fread("DemographySummary.txt")
Matrix<-as.matrix(Data[,c(3,4,5,6,8,9)])
rownames(Matrix)<-Data$Genotype
colnames(Matrix)<-c("MeanLS","MedianLS","LogAlpha","Beta","LogMiu45","LogMiu60")
pairs(Matrix,pch=20)
DF<-Data[,c(3,5,6)]
a<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),diag=list(continuous="bar"))+theme_bw()
colnames(DF)<-c("MeanLifespan","'log('*alpha*')'","beta")
b<-ggpairs(DF,axisLabels="none",lower=list(continuous="smooth"),
labeller=label_parsed)+theme_bw()
pdf("LSCorrelation.pdf", width=5, height=4)
b
dev.off()
Data
lm<-lm(MeanLS~LogMAlpha+MBeta,data=Data)
summary(lm)
anova(lm)
shapiro.test(Data$LogMAlpha)
shapiro.test(Data$LogMBeta)
shapiro.test(Data$MBeta)
?cor.test
cor.test(Data$LogMAlpha,Data$MBeta,method="spearman")
cor.test(Data$MeanLS,Data$LogMiu45)
cor.test(Data$MeanLS,Data$LogMiu60)
shapiro.test(Data$MeanLS)
shapiro.test(Data$LogMiu45)
shapiro.test(Data$LogMiu60)
cor.test(Data$MeanLS,Data$LogMiu45,method="spearman")
cor.test(Data$MeanLS,Data$LogMiu60,method="spearman")
library(data.table)
library(tidyverse)
library(lme4)
library(ggforce)
Data<-fread("ClimbingActivity20_Raw.txt")
## Collapse flies within the same vial
Climb_MeanAbs<-Data[,.(mean(AdjFlyHeight)),by=.(Block,Genotype,Week,Chamber)]
Climb_SEAbs<-Data[,.(sd(AdjFlyHeight)/sqrt(.N)),by=.(Block,Genotype,Week,Chamber)]
Climb_MeanP<-Data[,.(mean(AdjFlyHeight/AdjMaxHeight)),by=.(Block,Genotype,Week,Chamber)]
Climb_SEP<-Data[,.(sd(AdjFlyHeight/AdjMaxHeight)/sqrt(.N)),by=.(Block,Genotype,Week,Chamber)]
Climb<-data.frame(Block=Climb_MeanAbs$Block,Genotype=Climb_MeanAbs$Genotype,
Week=Climb_MeanAbs$Week,Mean=Climb_MeanAbs$V1,SE=Climb_SEAbs$V1)
ClimbP<-data.frame(Block=Climb_MeanAbs$Block,Genotype=Climb_MeanAbs$Genotype,
Week=Climb_MeanAbs$Week,Mean=Climb_MeanP$V1,SE=Climb_SEP$V1)
fit<-lm(Mean~Block+Genotype+as.character(Week),data=Climb)
anova(fit)
fit<-lm(Mean~Block+Genotype+as.character(Week),data=ClimbP)
anova(fit)
Plot<-ggplot(ClimbP,aes(y=Mean,x=as.character(Week)))+geom_boxplot()+theme_bw()
Plot+facet_wrap('Genotype')
## Collapse biological replicates
ClimbSummary<-ClimbP %>% group_by(Block,Genotype,Week) %>% summarise(PHeight=mean(Mean))
fit<-lm(PHeight~Block+Genotype+as.character(Week),data=ClimbSummary)
anova(fit)
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(data.table)
library(tidyverse)
Fec<-fread("ReproductiveOutput_Raw.txt")
Fec[,PCF:=Fecundity/Interval/N]
Fec[,ReproductiveOutput:=sqrt(PCF)]
Fec<-Fec[Time!="Day04"]
shapiro.test(Fec$ReproductiveOutput)
Fec$Vial<-as.character(rep(1:99,2))
Fec08<-filter(Fec,Time=="Day08")
Fec12<-filter(Fec,Time=="Day12")
anova(lm(ReproductiveOutput~Block+Genotype+Time+Vial,data=Fec))
by_genotype<-group_by(Fec,Genotype,Time,Block)
SumFec<-summarise(by_genotype,VialN=n(),MeanRO=mean(ReproductiveOutput,na.rm=TRUE),SdRO=sd(ReproductiveOutput,na.rm=TRUE))
SumFec<-data.table(SumFec)
## Substantial genetic variation
anova(lm(MeanRO~Block+Genotype+Time,data=SumFec))
Short<-select(SumFec,Genotype,Block,Time,MeanRO)
Short<-spread(Short,Time,MeanRO)
colnames(Short)[3:4]<-c("RepOutput_Day08","RepOutput_Day12")
write.table(Short,"ReproductiveOutputInfo_Genotype20.txt",quote=F,sep="\t",row.names=F)
## Correlation between Day 8 and Day 12 reproductive output
cor.test(Short$RepOutput_Day08, Short$RepOutput_Day12)
Pheno<-fread("Pheno20.txt")
Matrix<-as.matrix(Pheno[,c(3:5,8:14)])
rownames(Matrix)<-Pheno$Genotype
# colnames(Matrix)<-c("MeanLS","LogAlpha","Beta","RepOutput_Day08","RepOutput_Day12",
#                     "Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
colnames(Matrix)<-c("MeanLS",":log(alpha)",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
cor.test(Pheno$MeanLS,Pheno$RepOutput_Day08, method="spearman")
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(ggExtra)
library(corrplot)
library(dplyr)
library(ggplot2)
library(ggExtra)
library(corrplot)
Pheno<-fread("Pheno1.txt")
library(data.table)
library(dplyr)
library(ggplot2)
library(ggExtra)
library(corrplot)
Pheno<-fread("Pheno1.txt")
Pheno
setwd("~/Desktop/Metabolomics1Paper/DataAndCode/OrganismalPhenotypes")
library(data.table)
library(dplyr)
library(ggplot2)
library(ggExtra)
library(corrplot)
Pheno<-fread("Pheno_20.txt")
Pheno
Matrix<-as.matrix(Pheno[,c(3,5,6,14,15,16,17,18,19,20,21,25)])
Matrix
rownames(Matrix)<-Pheno$Genotype
Matrix
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
colnames(Matrix)<-c("MeanLS",":log(alpha)",":beta","RepOutput_Day08","RepOutput_Day12",
"Activity_Week1","Activity_Week2","Activity_Week3","Activity_Week4","Activity_Week5","Activity_Week6","ActivityDecline")
Cor<-cor(Matrix,method="spearman",use="pairwise.complete.obs")
pdf("PhenotypeCor_Genotype20.pdf", width=5, height=5)
corrplot(Cor, method = "circle",type="lower")
dev.off()
shapiro.test(Pheno$MeanLS)
shapiro.test(Pheno$LogMAlpha)
shapiro.test(Pheno$MBeta)
shapiro.test(Pheno$RepOutput_Day08)
shapiro.test(Pheno$RepOutput_Day12)
shapiro.test(Pheno$Week3)
shapiro.test(Pheno$Week4)
shapiro.test(Pheno$Week5)
shapiro.test(Pheno$Week1)
shapiro.test(Pheno$Week2)
shapiro.test(Pheno$Week3)
shapiro.test(Pheno$Week4)
shapiro.test(Pheno$Week5)
shapiro.test(Pheno$Week6)
shapiro.test(Pheno$Slope)
cor.test(Pheno$MeanLS,Pheno$Week1, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week2, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week3, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week4, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week5, method="spearman")
cor.test(Pheno$MeanLS,Pheno$Week6, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$Week1, method="spearman")
cor.test(Pheno$LogMAlpha,Pheno$Week2, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week1, method="spearman")
cor.test(Pheno$MBeta,Pheno$Week2, method="spearman")
?corrplot
pdf("PhenotypeCor_Genotype20.pdf", width=5, height=5)
corrplot(Cor, method = "circle",type="lower",diag=FALSE)
dev.off()
